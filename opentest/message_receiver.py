from tornado.httpserver import HTTPServer
import tornado.ioloop
import tornado.web
import ssl
from lxml import etree

class MessageReceiver(tornado.web.RequestHandler):
    def initialize(self, servicesDict):
        pass

    def post(self):
        print(etree.tostring(etree.fromstring(self.request.body), pretty_print=True).decode())


if __name__ == "__main__":
    servicesDict = {}
    application = tornado.web.Application([(r"/spine", MessageReceiver, dict(servicesDict=servicesDict))])
    crt = 'server.crt'
    key = 'server.key'
    ca = 'ca.crt'

    httpsServer = HTTPServer(application, ssl_options=dict(certfile=crt,
                                                           keyfile=key,
                                                           ca_certs=ca,
                                                           cert_reqs=ssl.CERT_REQUIRED))
    httpsServer.listen(443)
    tornado.ioloop.IOLoop.instance().start()